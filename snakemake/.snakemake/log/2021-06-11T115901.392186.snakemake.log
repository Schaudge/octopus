Building DAG of jobs...
Job counts:
	count	jobs
	1	all
	1	bwa_index
	1	bwa_map
	2	download_fastqs
	1	download_hs38DH
	1	download_syndip
	1	generate_hs38DH_chromosomes_bed
	1	octopus
	1	rtg_format
	1	samtools_index_bam
	1	samtools_index_fasta
	1	vcfeval
	13

[Fri Jun 11 11:59:01 2021]
rule download_fastqs:
    output: data/reads/raw/CHM1-CHM13_1.fastq.gz
    jobid: 9
    wildcards: strand=1

curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR134/003/ERR1341793/ERR1341793_1.fastq.gz | gzip > data/reads/raw/CHM1-CHM13_1.fastq.gz

[Fri Jun 11 11:59:01 2021]
rule download_fastqs:
    output: data/reads/raw/CHM1-CHM13_2.fastq.gz
    jobid: 10
    wildcards: strand=2

curl ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR134/003/ERR1341793/ERR1341793_2.fastq.gz | gzip > data/reads/raw/CHM1-CHM13_2.fastq.gz

[Fri Jun 11 11:59:01 2021]
rule download_hs38DH:
    output: data/references/hs38DH.fa, data/references/hs38DH.fa.alt
    jobid: 3


        run-gen-ref hs38DH
        mv hs38DH.fa* $(dirname data/references/hs38DH.fa)
        

[Fri Jun 11 11:59:01 2021]
rule download_syndip:
    output: data/truth/CHM1-CHM13.hs38DH.vcf.gz, data/truth/CHM1-CHM13.hs38DH.vcf.gz.tbi, data/truth/CHM1-CHM13.hs38DH.bed.gz, data/truth/CHM1-CHM13.hs38DH.bed.gz.tbi, data/truth/syndip_tmp
    jobid: 4


        curl -L https://github.com/lh3/CHM-eval/releases/download/v0.5/CHM-evalkit-20180222.tar | tar xf - > data/truth/syndip_tmp
        mv data/truth/syndip_tmp/full.38.vcf.gz data/truth/CHM1-CHM13.hs38DH.vcf.gz
        mv data/truth/syndip_tmp/full.38.vcf.gz.tbi data/truth/CHM1-CHM13.hs38DH.vcf.gz.tbi
        mv data/truth/syndip_tmp/full.38.bed.gz data/truth/CHM1-CHM13.hs38DH.bed.gz
        mv data/truth/syndip_tmp/full.38.bed.gz.tbi data/truth/CHM1-CHM13.hs38DH.bed.gz.tbi
        

[Fri Jun 11 11:59:01 2021]
rule rtg_format:
    input: data/references/hs38DH.fa
    output: data/references/hs38DH.sdf
    jobid: 2
    wildcards: prefix=data/references/hs38DH

rtg format data/references/hs38DH.fa -o data/references/hs38DH.sdf

[Fri Jun 11 11:59:01 2021]
rule samtools_index_fasta:
    input: data/references/hs38DH.fa
    output: data/references/hs38DH.fa.fai
    jobid: 8
    wildcards: fasta=data/references/hs38DH.fa

samtools faidx data/references/hs38DH.fa

[Fri Jun 11 11:59:01 2021]
rule generate_hs38DH_chromosomes_bed:
    input: data/references/hs38DH.fa.fai
    output: data/references/hs38DH.chromosomes.bed
    jobid: 12

head -25 data/references/hs38DH.fa.fai | awk -v OFS='	' '{print $1,0,$2}' > data/references/hs38DH.chromosomes.bed

[Fri Jun 11 11:59:01 2021]
rule bwa_index:
    input: data/references/hs38DH.fa, data/references/hs38DH.fa.fai
    output: data/references/hs38DH.fa.amb, data/references/hs38DH.fa.ann, data/references/hs38DH.fa.bwt, data/references/hs38DH.fa.pac, data/references/hs38DH.fa.sa
    jobid: 7
    wildcards: reference=hs38DH

bwa index data/references/hs38DH.fa

[Fri Jun 11 11:59:01 2021]
rule bwa_map:
    input: data/references/hs38DH.fa.amb, data/references/hs38DH.fa.ann, data/references/hs38DH.fa.bwt, data/references/hs38DH.fa.pac, data/references/hs38DH.fa.sa, data/references/hs38DH.fa, data/references/hs38DH.fa.fai, data/reads/raw/CHM1-CHM13_1.fastq.gz, data/reads/raw/CHM1-CHM13_2.fastq.gz
    output: data/reads/mapped/CHM1-CHM13.hs38DH.bwa-mem.bam
    log: logs/bwa/CHM1-CHM13.hs38DH.log
    jobid: 6
    wildcards: library=CHM1-CHM13, reference=hs38DH

(bwa mem -t 1 -R '@RG\tID:CHM1-CHM13\tSM:CHM1-CHM13\tLB:CHM1-CHM13\tPU:Illumina' data/references/hs38DH.fa data/reads/raw/CHM1-CHM13_1.fastq.gz data/reads/raw/CHM1-CHM13_2.fastq.gz |           samtools view -bh |           samtools sort -@ 4 -m 4G -o data/reads/mapped/CHM1-CHM13.hs38DH.bwa-mem.bam)          2> logs/bwa/CHM1-CHM13.hs38DH.log

[Fri Jun 11 11:59:01 2021]
rule samtools_index_bam:
    input: data/reads/mapped/CHM1-CHM13.hs38DH.bwa-mem.bam
    output: data/reads/mapped/CHM1-CHM13.hs38DH.bwa-mem.bam.bai
    jobid: 11
    wildcards: prefix=CHM1-CHM13.hs38DH.bwa-mem

samtools index data/reads/mapped/CHM1-CHM13.hs38DH.bwa-mem.bam

[Fri Jun 11 11:59:01 2021]
rule octopus:
    input: data/references/hs38DH.fa, data/reads/mapped/CHM1-CHM13.hs38DH.bwa-mem.bam, data/reads/mapped/CHM1-CHM13.hs38DH.bwa-mem.bam.bai, data/references/hs38DH.chromosomes.bed
    output: results/calls/CHM1-CHM13.hs38DH.bwa-mem.octopus.vcf.gz, results/calls/CHM1-CHM13.hs38DH.bwa-mem.octopus.vcf.gz.tbi
    log: logs/octopus/CHM1-CHM13.hs38DH.bwa-mem.log
    jobid: 5
    benchmark: results/benchmarks/octopus/CHM1-CHM13.hs38DH.bwa-mem.tsv
    wildcards: library=CHM1-CHM13, reference=hs38DH, mapper=bwa-mem

(octopus          -R data/references/hs38DH.fa          -I data/reads/mapped/CHM1-CHM13.hs38DH.bwa-mem.bam          -t data/references/hs38DH.chromosomes.bed          --sequence-error-model PCRF.X10          --forest /opt/octopus/resources/forests/germline.v0.7.4.forest          -o results/calls/CHM1-CHM13.hs38DH.bwa-mem.octopus.vcf.gz results/calls/CHM1-CHM13.hs38DH.bwa-mem.octopus.vcf.gz.tbi          --threads 1          2> logs/octopus/CHM1-CHM13.hs38DH.bwa-mem.log

[Fri Jun 11 11:59:01 2021]
rule vcfeval:
    input: data/references/hs38DH.sdf, data/truth/CHM1-CHM13.hs38DH.vcf.gz, data/truth/CHM1-CHM13.hs38DH.vcf.gz.tbi, data/truth/CHM1-CHM13.hs38DH.bed.gz, results/calls/CHM1-CHM13.hs38DH.bwa-mem.octopus.vcf.gz, results/calls/CHM1-CHM13.hs38DH.bwa-mem.octopus.vcf.gz.tbi
    output: results/eval/CHM1-CHM13.hs38DH.bwa-mem.octopus.pass.vcfeval
    log: logs/eval/CHM1-CHM13.hs38DH.bwa-mem.octopus.pass.vcfeval.log
    jobid: 1
    wildcards: library=CHM1-CHM13, reference=hs38DH, mapper=bwa-mem, caller=octopus, filter=pass
    resources: mem_gb=40

InputFunctionException in line 150 of /Users/dcooke/Development/octopus/website/static/snakemake/germline.smk:
Error:
  KeyError: 'score_fields'
Wildcards:
  library=CHM1-CHM13
  reference=hs38DH
  mapper=bwa-mem
  caller=octopus
  filter=pass
Traceback:
  File "/Users/dcooke/Development/octopus/website/static/snakemake/germline.smk", line 163, in <lambda>
  File "/usr/local/Cellar/snakemake/6.4.1/libexec/lib/python3.9/site-packages/snakemake/executors/__init__.py", line 136, in run_jobs
  File "/usr/local/Cellar/snakemake/6.4.1/libexec/lib/python3.9/site-packages/snakemake/executors/__init__.py", line 145, in run
  File "/usr/local/Cellar/snakemake/6.4.1/libexec/lib/python3.9/site-packages/snakemake/executors/__init__.py", line 156, in _run
  File "/usr/local/Cellar/snakemake/6.4.1/libexec/lib/python3.9/site-packages/snakemake/executors/__init__.py", line 176, in printjob
  File "/usr/local/Cellar/snakemake/6.4.1/libexec/lib/python3.9/site-packages/snakemake/executors/__init__.py", line 162, in printjob
